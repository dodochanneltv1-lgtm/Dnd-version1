<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DnD World (v2)</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            display: flex;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        /* 1. ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô) */
        #main-controls {
            flex-shrink: 0;
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid #ffae00;
            padding: 10px;
            text-align: center;
            z-index: 10;
        }
        
        #main-controls button {
            width: auto;
            padding: 8px 15px;
            margin: 0 5px;
            font-size: 0.9em;
        }

        /* 2. ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å (‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà + ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î) */
        #content-area {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
            position: relative; /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Modal */
        }

        /* 2.1 UI ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞ Modal (‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡∏±‡∏ö‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô) */
        #map-ui-container {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 0, 0, 0.75);
            backdrop-filter: blur(5px);
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: white;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        #map-ui-container.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .map-panel, .shop-panel, .guild-panel, .inn-panel {
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 20px;
            background: rgba(20, 10, 0, 0.9);
            border: 1px solid #ffae00;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(255, 165, 0, 0.5);
        }

        .map-panel h2, .shop-panel h2, .guild-panel h2, .inn-panel h2 {
            margin-top: 0;
            color: #ffc107;
            border-bottom: 1px solid #ffae00;
            padding-bottom: 10px;
        }

        .map-panel button, .shop-panel button, .guild-panel button, .inn-panel button {
            display: block;
            width: 100%;
            margin-bottom: 10px;
        }

        /* 2.2 Iframe ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î (‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î) */
        #dashboard-iframe-container {
            flex-grow: 1;
            height: 100%;
            border: none;
        }
        
        #dashboard-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* UI ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏Å‡∏¥‡∏•‡∏î‡πå (‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ) */
        .hidden { display: none; }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏Å‡∏¥‡∏•‡∏î‡πå */
        .shop-item, .guild-quest {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #a97125;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }
        .shop-item h4, .guild-quest h4 {
            margin: 0 0 10px 0;
            color: #ffeb8a;
        }
        .shop-item p, .guild-quest p {
            margin: 5px 0;
            font-family: 'Prompt', sans-serif;
        }
        .shop-item .price {
            font-size: 1.2em;
            font-weight: bold;
            color: #ffd700;
        }
        .shop-item button, .guild-quest button {
            width: auto;
            padding: 5px 15px;
            margin-top: 10px;
            background-color: #28a745;
        }
        .guild-quest button[disabled] {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
    </style>
</head>
<body>

    <!-- 1. ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô) -->
    <div id="main-controls">
        <button id="btn-show-world" onclick="showMapUI('world')">üó∫Ô∏è ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏Å‡πÄ‡∏°‡∏∑‡∏≠‡∏á</button>
        <button id="btn-show-city" onclick="showMapUI('city')">üèôÔ∏è ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á</button>
        <button id="btn-show-building" onclick="showMapUI('building')">üèõÔ∏è ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</button>
        <a href="lobby.html" style="float: right;"><button style="background-color: #6c757d;">üö™ ‡∏Å‡∏•‡∏±‡∏ö‡∏•‡πá‡∏≠‡∏ö‡∏ö‡∏µ‡πâ</button></a>
    </div>

    <!-- 2. ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
    <div id="content-area">

        <!-- 2.1 UI ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞ Modal (‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡∏±‡∏ö‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô) -->
        <div id="map-ui-container" class="hidden">
            
            <!-- 2.1.1 ‡∏£‡∏∞‡∏î‡∏±‡∏ö 1: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏Å‡πÄ‡∏°‡∏∑‡∏≠‡∏á -->
            <div id="world-map-panel" class="map-panel hidden">
                <h2>üó∫Ô∏è ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏Å‡πÄ‡∏°‡∏∑‡∏≠‡∏á</h2>
                <button onclick="showMapUI('city')">‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á</button>
                <button style="background-color: #6c757d;" disabled>‡∏õ‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏° (Lvl 10+)</button>
                <button style="background-color: #6c757d;" disabled>‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÑ‡∏ü (Lvl 30+)</button>
                <button onclick="hideMapUI()">‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</button>
            </div>

            <!-- 2.1.2 ‡∏£‡∏∞‡∏î‡∏±‡∏ö 2: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á -->
            <div id="city-map-panel" class="map-panel hidden">
                <h2>üèôÔ∏è ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á</h2>
                <button onclick="showMapUI('building')">‡πÑ‡∏õ‡∏¢‡πà‡∏≤‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ (‡∏Å‡∏¥‡∏•‡∏î‡πå/‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤)</button>
                <button onclick="showMapUI('world')">‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÄ‡∏°‡∏∑‡∏≠‡∏á</button>
                <button style="background-color: #6c757d;" disabled>‡πÇ‡∏Ñ‡∏•‡∏≠‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏°</button>
                <button onclick="hideMapUI()">‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</button>
            </div>

            <!-- 2.1.3 ‡∏£‡∏∞‡∏î‡∏±‡∏ö 3: ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ -->
            <div id="building-map-panel" class="map-panel hidden">
                <h2>üèõÔ∏è ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</h2>
                <button onclick="showBuildingUI('guild')">1. ‡∏Å‡∏¥‡∏•‡∏î‡πå‡∏ô‡∏±‡∏Å‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢</button>
                <button onclick="showBuildingUI('shops')">2. ‡∏¢‡πà‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                <button onclick="showBuildingUI('inn')">3. ‡πÇ‡∏£‡∏á‡πÄ‡∏ï‡∏µ‡πä‡∏¢‡∏°</button>
                <button onclick="showMapUI('city')">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡∏≠‡∏á</button>
                <button onclick="hideMapUI()">‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</button>
            </div>

            <!-- 2.1.4 ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡∏Å‡∏¥‡∏•‡∏î‡πå (‡∏Ç‡πâ‡∏≠ 10) -->
            <div id="guild-panel" class="guild-panel hidden">
                <h2>üìú ‡∏Å‡∏¥‡∏•‡∏î‡πå‡∏ô‡∏±‡∏Å‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢</h2>
                <div id="guild-quest-list">
                    <!-- Javascript/map.js ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Ñ‡∏ß‡∏™‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Ñ‡∏ß‡∏™...</p>
                </div>
                <hr>
                <div id="guild-subclass-section" class="hidden">
                    <h4>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏£‡∏≠‡∏á (Level 10+)</h4>
                    <select id="subclass-select">
                        <!-- Javascript/map.js ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û T1 ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏´‡∏•‡∏±‡∏Å -->
                    </select>
                    <button onclick="registerSubClass()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏£‡∏≠‡∏á</button>
                </div>
                <hr>
                <button onclick="showMapUI('building')">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏¥‡∏•‡∏î‡πå</button>
            </div>

            <!-- 2.1.5 ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡πÇ‡∏£‡∏á‡πÄ‡∏ï‡∏µ‡πä‡∏¢‡∏° (‡∏Ç‡πâ‡∏≠ 10) -->
            <div id="inn-panel" class="inn-panel hidden">
                <h2>üè® ‡πÇ‡∏£‡∏á‡πÄ‡∏ï‡∏µ‡πä‡∏¢‡∏°</h2>
                <p>‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏∞‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π HP, MP ‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                <p>(‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï: ‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏π‡∏•‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏™‡∏Å‡∏¥‡∏•‡πÅ‡∏ö‡∏ö PERSONAL ‡∏î‡πâ‡∏ß‡∏¢)</p>
                <button id="btn-rest" onclick="restAtInn()">‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô (‡∏£‡∏≤‡∏Ñ‡∏≤ 10 GP)</button>
                <hr>
                <button onclick="showMapUI('building')">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏ï‡∏µ‡πä‡∏¢‡∏°</button>
            </div>

            <!-- 2.1.6 ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏Ç‡πâ‡∏≠ 10) -->
            <div id="shop-select-panel" class="shop-panel hidden">
                <h2>üõçÔ∏è ‡∏¢‡πà‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                <button onclick="openShop('weapon_basic')">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</button>
                <button onclick="openShop('weapon_common')">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
                <button onclick="openShop('weapon_magic')">‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏ß‡∏ó‡∏¢‡πå</button>
                <button onclick="openShop('weapon_high')">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á</button>
                <button onclick="openShop('armor')">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡πÄ‡∏Å‡∏£‡∏≤‡∏∞</button>
                <button onclick="openShop('general')">‡∏£‡πâ‡∏≤‡∏ô‡∏à‡∏¥‡∏õ‡∏≤‡∏ñ‡∏∞</button>
                <hr>
                <button onclick="showMapUI('building')">‡∏Å‡∏•‡∏±‡∏ö‡∏¢‡πà‡∏≤‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</button>
            </div>
            
            <!-- 2.1.7 ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏≠‡πÄ‡∏ó‡∏°) (‡∏Ç‡πâ‡∏≠ 11) -->
            <div id="shop-item-panel" class="shop-panel hidden">
                <h2 id="shop-title">...</h2>
                <div id="shop-item-list">
                    <!-- Javascript/map.js ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</p>
                </div>
                <hr>
                <button onclick="showBuildingUI('shops')">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡πà‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</button>
            </div>

        </div> <!-- #map-ui-container -->


        <!-- 2.2 Iframe ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î (‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î) (‡∏Ç‡πâ‡∏≠ 5) -->
        <div id="dashboard-iframe-container">
            <iframe id="dashboard-iframe" src="player-dashboard.html"></iframe>
        </div>

    </div> <!-- #content-area -->

    <!-- [‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç] ‡πÇ‡∏´‡∏•‡∏î Scripts (v2) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <script src="Javascript/firebase-init.js"></script>
    <script src="Javascript/ui-helpers.js"></script>
    
    <!-- ‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏é (v2) -->
    <script src="Javascript/skills-data.js"></script> 
    <!-- ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (v2) -->
    <script src="Javascript/charector.js"></script>   
    
    <!-- ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ (‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏±‡∏î‡πÑ‡∏õ) -->
    <script src="Javascript/map.js"></script>
</body>
</html>
