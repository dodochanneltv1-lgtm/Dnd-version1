<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Fixed Layers</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* --- Reset & Base --- */
        * { box-sizing: border-box; }
        body {
            margin: 0; padding: 0;
            background: rgba(0, 0, 0, 0.85);
            font-family: 'Prompt', sans-serif;
            color: white;
            width: 100vw; height: 100vh;
            overflow: hidden;
            display: flex; justify-content: center; align-items: center;
        }

        /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å */
        #social-window {
            width: 95%; max-width: 1100px;
            height: 90%; max-height: 800px;
            background: #111;
            border: 2px solid #ffae00;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
            overflow: hidden;
        }

        /* --- Sidebar (‡∏ã‡πâ‡∏≤‡∏¢) --- */
        #layer-sidebar {
            position: absolute; top: 0; left: 0; bottom: 0; width: 280px;
            background: #1a1a1a; border-right: 1px solid #333; z-index: 10;
            display: flex; flex-direction: column;
        }
        .sidebar-header { height: 120px; padding: 15px; background: #222; border-bottom: 2px solid #ffae00; }
        .sidebar-scroll-area { flex: 1; overflow-y: auto; padding: 10px; }

        /* --- Chat Display (‡∏Ç‡∏ß‡∏≤) --- */
        #layer-chat-display {
            position: absolute; top: 0; right: 0; left: 280px; bottom: 70px;
            background: #000; z-index: 5;
            overflow-y: auto; overflow-x: hidden;
            padding: 20px;
            display: flex; flex-direction: column; gap: 15px; /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
            background-image: radial-gradient(#222 1px, transparent 1px); background-size: 20px 20px;
        }

        /* --- Chat Input (‡∏Ç‡∏ß‡∏≤ - ‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå) --- */
        #layer-chat-input {
            position: absolute; bottom: 0; right: 0; left: 280px; height: 70px;
            background: rgba(30, 30, 30, 0.95); border-top: 1px solid #ffae00; z-index: 20;
            display: flex; align-items: center; padding: 0 15px; backdrop-filter: blur(5px);
        }

        /* --- Message Row Layout (‡πÉ‡∏´‡∏°‡πà!) --- */
        .msg-row {
            display: flex;
            align-items: flex-start; /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏£‡∏π‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡πÄ‡∏™‡∏°‡∏≠ */
            gap: 10px;
            max-width: 80%; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏ó‡∏∞‡∏•‡∏∏‡∏à‡∏≠ */
            animation: slideUp 0.3s ease-out forwards;
        }
        
        /* ‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏£‡∏≤ (‡∏Ç‡∏ß‡∏≤) */
        .msg-row.mine {
            align-self: flex-end; /* ‡∏ä‡∏¥‡∏î‡∏Ç‡∏ß‡∏≤ */
            flex-direction: row-reverse; /* ‡∏£‡∏π‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤ */
        }
        
        /* ‡∏ù‡∏±‡πà‡∏á‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô (‡∏ã‡πâ‡∏≤‡∏¢) */
        .msg-row.other {
            align-self: flex-start; /* ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ */
        }

        /* ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÅ‡∏ä‡∏ó */
        .msg-avatar-img {
            width: 40px; height: 40px;
            border-radius: 50%;
            border: 2px solid #555;
            object-fit: cover;
            cursor: pointer;
            flex-shrink: 0; /* ‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏î */
        }
        .msg-row.mine .msg-avatar-img { border-color: #005c97; }
        .msg-row.other .msg-avatar-img { border-color: #ffae00; }

        /* ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (‡∏ä‡∏∑‡πà‡∏≠ + ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°) */
        .msg-content-col {
            display: flex;
            flex-direction: column;
        }
        
        /* ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏ä‡∏∑‡πà‡∏≠ + ‡∏¢‡∏®) */
        .msg-header-info {
            font-size: 0.8em;
            margin-bottom: 4px;
            color: #aaa;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .msg-row.mine .msg-header-info { justify-content: flex-end; } /* ‡∏ä‡∏∑‡πà‡∏≠‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏£‡∏≤‡∏ä‡∏¥‡∏î‡∏Ç‡∏ß‡∏≤ */

        /* ‡∏ï‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (Bubble) */
        .msg-bubble {
            padding: 10px 15px;
            border-radius: 12px;
            position: relative;
            line-height: 1.5;
            font-size: 0.95em;
            width: fit-content; /* ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
            word-break: break-word; /* ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡∏ñ‡πâ‡∏≤‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô */
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        /* ‡∏™‡∏µ‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏£‡∏≤ */
        .msg-row.mine .msg-bubble {
            background: linear-gradient(135deg, #005c97, #363795);
            color: white;
            border-top-right-radius: 0; /* ‡∏°‡∏∏‡∏°‡πÅ‡∏´‡∏•‡∏°‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ */
        }
        
        /* ‡∏™‡∏µ‡∏ù‡∏±‡πà‡∏á‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô */
        .msg-row.other .msg-bubble {
            background: #2a2a2a;
            color: #ddd;
            border: 1px solid #444;
            border-top-left-radius: 0; /* ‡∏°‡∏∏‡∏°‡πÅ‡∏´‡∏•‡∏°‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ */
        }

        /* ‡∏õ‡πâ‡∏≤‡∏¢‡∏¢‡∏® */
        .rank-badge {
            font-size: 0.7em; padding: 1px 5px; border-radius: 4px; font-weight: bold; text-transform: uppercase;
        }
        .rank-admin { background: #d9534f; color: white; border: 1px solid #c9302c; }
        .rank-beta { background: #5bc0de; color: white; border: 1px solid #46b8da; }

        /* ‡πÄ‡∏ß‡∏•‡∏≤ */
        .msg-time {
            font-size: 0.65em; opacity: 0.6; text-align: right; margin-top: 3px;
        }

        /* Animation */
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Components */
        .tab-btn { background: #333; color: #aaa; border: none; flex: 1; margin: 2px; padding: 8px; border-radius: 4px; cursor: pointer; }
        .tab-btn.active { background: #ffae00; color: #000; font-weight: bold; }
        .chat-input { flex: 1; padding: 10px 15px; border-radius: 20px; background: #000; border: 1px solid #444; color: white; outline: none; }
        .send-btn { width: 45px; height: 45px; margin-left: 10px; border-radius: 50%; background: #ffae00; border: none; font-size: 1.2em; cursor: pointer; }

        /* Modal */
        #profileModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; display: none; justify-content: center; align-items: center; }
        .modal-box { background: #1c1c1c; border: 2px solid #ffae00; padding: 20px; border-radius: 10px; width: 350px; text-align: center; animation: zoomIn 0.3s; }
        @keyframes zoomIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
    </style>
</head>
<body>

<div id="social-window">
    
    <div id="layer-sidebar">
        <div class="sidebar-header">
            <h3 style="margin:0 0 10px 0; color:#ffae00;">üí¨ Social Hub</h3>
            <div style="display:flex; flex-wrap:wrap;">
                <button class="tab-btn active" onclick="switchTab('world')">üåé ‡πÇ‡∏•‡∏Å</button>
                <button class="tab-btn" onclick="switchTab('friends')">üë• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</button>
                <button class="tab-btn" onclick="switchTab('add')">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                <button class="tab-btn" onclick="switchTab('requests')">üîî <span id="reqCount">0</span></button>
            </div>
        </div>
        <div id="sidebar-list" class="sidebar-scroll-area">
            </div>
    </div>

    <div id="layer-chat-display">
        <div style="text-align:center; color:#555; margin-top:50px;">
            ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡πÅ‡∏ä‡∏ó‡πÇ‡∏•‡∏Å<br>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢
        </div>
    </div>

    <div id="layer-chat-input">
        <input type="text" id="chatInput" class="chat-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
        <button class="send-btn" onclick="sendMessageAction()">‚û§</button>
    </div>

</div>

<div id="profileModal">
    <div class="modal-box">
        <button onclick="document.getElementById('profileModal').style.display='none'" style="float:right; background:none; border:none; color:red; font-size:1.5em; cursor:pointer;">&times;</button>
        <img id="modalAvatar" src="" style="width:100px; height:100px; border-radius:50%; border:3px solid #ffae00; object-fit:cover; margin-bottom:10px;">
        <h2 id="modalName" style="color:#ffae00; margin:0;">Username</h2>
        <div id="modalRole" style="margin-bottom:10px;"></div>
        <div style="background:#333; padding:10px; border-radius:5px; margin:10px 0; font-style:italic; color:#aaa;">"<span id="modalBio">-</span>"</div>
        <button id="modalActionBtn" style="padding:8px 15px; border-radius:5px; border:none; background:#28a745; color:white; cursor:pointer; width:100%;">Button</button>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="Javascript/firebase-init.js"></script>
<script src="Javascript/ui-helpers.js"></script>
<script src="Javascript/social.js"></script>

</body>
</html>